<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://code.jquery.com/jquery-3.7.1.slim.min.js"
      integrity="sha256-kmHvs0B+OpCW5GVHUNjv9rOmY0IvSIRcf7zGUDTDQM8="
      crossorigin="anonymous"></script>
  </head>
  <body id="body_section">
    <div id="first_section">
      <p>Do you want to participate in quiz?</p>
      <button onclick="takeQuiz()">Yes</button>
      <button onclick="cancelQuiz()">No</button>
    </div>
    <div id="question_section" style="display: none;">
      <h4 id="quesiton"></h4>
      <div id="options">
        <select id="option_select">
        </select>
      </div>
    </div>
  </body>
</html>
<script>
  let marks = 0;
  let j = 0;
  var question = [];
  var question_index = [];

  function takeQuiz() {
    fetch('http://localhost:3000/takeQuiz')
    .then(function (response) {
      if (response.status !== 200) {
        console.log(
          'Looks like there was a problem. Status Code: ' + response.status
        );
        return;
      }
      response.json().then(function (data) {
        question = data.results;
        populateQuestion();
      });
    })
    .catch(function (err) {
      console.log(err);
    });
}


// Do not need to this but still doing it fetching the request
function cancelQuiz() {
    fetch('http://localhost:3000/cancelQuiz')
    .then(function (response) {
      if (response.status !== 200) {
        console.log(
          'Looks like there was a problem. Status Code: ' + response.status
        );
        return;
      }
      response.json().then(function (data) {
        let message = data.message;
        alert(message);
       
      });
    })
    .catch(function (err) {
      console.log(err);
    });
}

function populateQuestion(){
       $('#first_section').css('display', 'none');
        $('#question_section').css('display', 'block')
        var option_html= '';
        let options  = question[j]['incorrect_answers'];
        if(question[j].type == 'multiple'){
          option_html+=`<option value="${question[j]['correct_answer']}">${question[j]['correct_answer']}</option>`;
          options.forEach((e,ind,a)=>{
            option_html+=`<option value="${e}">${e}</option>`;
          })
        }else if(question[j].type == 'boolean'){
           option_html ='<option value="True">True</option><option value="False">False</option>'
        }
        $('#quesiton').html(question[j]['question'])
        if(j!=0){
          checkAnswer($('#option_select').val(), j-1)
        }
     
        $('#option_select').html(option_html);
        $('#options').append(`<button id="btn_${j}" onclick="populateQuestion(${j})">Submit answer</button>`);
        if(j!=0){
          $(`#btn_${j}`).remove();
        }
        j++;

}

function checkAnswer(sel_ans, q_num){
  console.log(sel_ans, q_num);
 // poppulateQuestion()
}
</script>